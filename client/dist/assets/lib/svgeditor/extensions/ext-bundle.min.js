window.extConnector=function(){window.svgEditor&&svgEditor.addExtension("Connector",function(e){var v,u,m,p,f,h,x=e.svgcontent,c=e.svgroot,l=e.getNextId,w=e.getElem,y=e.addSvgElementFromJson,b=e.selectorManager,g=svgEditor.curConfig,k=!1,_=[],C=".se_connector",E=[],S=$.data,t={en:[{id:"mode_connect",title:"Connect two objects"}],fr:[{id:"mode_connect",title:"Connecter deux objets"}]};function A(e,t,r,n){n&&(n-=0,(r=$.extend({},r)).width+=n,r.height+=n,r.x-=n/2,r.y-=n/2);var i,o=r.x+r.width/2,a=r.y+r.height/2,s=e-o,d=t-a;return{x:o+s*(i=Math.abs(d/s)<r.height/r.width?r.width/2/Math.abs(s):r.height/2/Math.abs(d)),y:a+d*i}}function M(e,t){var r=!!t.getAttribute("marker-"+e),n=5*t.getAttribute("stroke-width");return r?n:0}function n(e){var t=$("#connector_rules");t.length||(t=$('<style id="connector_rules"></style>').appendTo("head")),t.text(e?"#tool_clone, #tool_topath, #tool_angle, #xy_panel { display: none !important; }":""),$("#connector_panel").toggle(e)}function I(t,r,n,i,e){var o,a=t.points,s=c.createSVGPoint();s.x=n,s.y=i,"end"===r&&(r=a.numberOfItems-1);try{a.replaceItem(s,r)}catch(e){var d=t.getAttribute("points").split(" ");for(o=0;o<d.length;o++)o===r&&(d[o]=n+","+i);t.setAttribute("points",d.join(" "))}if(e){var l=a.getItem(0),g=a.getItem(a.numberOfItems-1);I(t,1,(g.x+l.x)/2,(g.y+l.y)/2)}}function N(s){var d;s||(s=E);var e=$(x).find(C);_=[],e.each(function(){var e;function t(){-1!==$.inArray(this,s)&&(e=!0)}var r=S(this,"c_start"),n=S(this,"c_end"),i=[w(r),w(n)];for(d=0;d<2;d++){var o=i[d];if(e=!1,$(o).parents().each(t),o&&o.parentNode){if(-1!==$.inArray(o,s)||e){var a=svgCanvas.getStrokedBBox([o]);_.push({elem:o,connector:this,is_start:0===d,start_x:a.x,start_y:a.y})}}else $(this).remove()}})}function F(e){var t,r;if(N(e),_.length)for(t=_.length;t--;){var n=_[t],i=n.connector,o=n.elem,a=(i.getAttribute("stroke-width"),n.is_start?"start":"end"),s=svgCanvas.getStrokedBBox([o]);s.x=n.start_x,s.y=n.start_y,S(i,a+"_bb",s);S(i,a+"_off");var d=n.is_start?"end":"start",l=S(i,d+"_bb"),g=A(l.x+l.width/2,l.y+l.height/2,s,M(a,i));I(i,n.is_start?0:"end",g.x,g.y,!0);var c=A(g.x,g.y,S(i,d+"_bb"),M(d,i));if(I(i,n.is_start?"end":0,c.x,c.y,!0),-1!==navigator.userAgent.indexOf("AppleWebKit")){var v=i.points,u=v.numberOfItems,m=[];for(r=0;r<u;r++)g=v.getItem(r),m[r]=g.x+","+g.y;i.setAttribute("points",m.join(" "))}}}return function(){var e=svgCanvas.groupSelectedElements;svgCanvas.groupSelectedElements=function(){return svgCanvas.removeFromSelection($(C).toArray()),e.apply(this,arguments)};var t=svgCanvas.moveSelectedElements;svgCanvas.moveSelectedElements=function(){svgCanvas.removeFromSelection($(C).toArray());var e=t.apply(this,arguments);return F(),e},h=svgCanvas.getEditorNS()}(),{name:"Connector",buttons:[{id:"mode_connect",type:"mode",title:"Connect two objects",includeWith:{button:"#tool_line",isDefault:!1,position:1},events:{click:function(){svgCanvas.setMode("connector")}}}],addLangData:function(e){return{data:t[e]}},mouseDown:function(e){var t=e.event;v=e.start_x,u=e.start_y;var r=svgCanvas.getMode();if("connector"==r){if(k)return;var n=t.target,i=$(n).parents();if(-1!==$.inArray(x,i)){var o=$(n).closest("foreignObject");p=o.length?o[0]:n;var a=svgCanvas.getStrokedBBox([p]),s=a.x+a.width/2,d=a.y+a.height/2;k=!0,m=y({element:"polyline",attr:{id:l(),points:s+","+d+" "+s+","+d+" "+v+","+u,stroke:"#"+g.initStroke.color,"stroke-width":p.stroke_width&&0!=p.stroke_width?p.stroke_width:g.initStroke.width,fill:"none",opacity:g.initStroke.opacity,style:"pointer-events:none"}}),S(m,"start_bb",a)}return{started:!0}}"select"==r&&N()},mouseMove:function(e){var t=svgCanvas.getZoom(),r=(e.event,e.mouse_x/t),n=e.mouse_y/t,i=r-v,o=n-u,a=svgCanvas.getMode();if("connector"==a&&k){m.getAttribute("stroke-width");var s=A(r,n,S(m,"start_bb"),M("start",m));v=s.x,u=s.y,I(m,0,s.x,s.y,!0),I(m,"end",r,n,!0)}else if("select"==a){for(var d=E.length;d--;){var l=E[d];l&&S(l,"c_start")&&(svgCanvas.removeFromSelection([l]),svgCanvas.getTransformList(l).clear())}_.length&&function(e,t){for(var r=_.length;r--;){var n=_[r],i=n.connector,o=(n.elem,n.is_start?"start":"end"),a=S(i,o+"_bb");a.x=n.start_x+e,a.y=n.start_y+t,S(i,o+"_bb",a);var s=n.is_start?"end":"start",d=S(i,s+"_bb"),l=A(d.x+d.width/2,d.y+d.height/2,a,M(o,i));I(i,n.is_start?0:"end",l.x,l.y,!0);var g=A(l.x,l.y,S(i,s+"_bb"),M(s,i));I(i,n.is_start?"end":0,g.x,g.y,!0)}}(i,o)}},mouseUp:function(e){var t=svgCanvas.getZoom(),r=e.event,n=(e.mouse_x,e.mouse_y,r.target);if("connector"==svgCanvas.getMode()){var i=$(n).closest("foreignObject");i.length&&(n=i[0]);var o=$(n).parents();if(n==p)return{keep:k=!0,element:null,started:k};if(-1===$.inArray(x,o))return $(m).remove(),{keep:k=!1,element:null,started:k};f=n;var a=p.id,s=f.id,d=a+" "+s,l=s+" "+a;if($(x).find(C).filter(function(){var e=this.getAttributeNS(h,"connector");if(e==d||e==l)return!0}).length)return $(m).remove(),{keep:!1,element:null,started:!1};var g=svgCanvas.getStrokedBBox([f]),c=A(v,u,g,M("start",m));return I(m,"end",c.x,c.y,!0),$(m).data("c_start",a).data("c_end",s).data("end_bb",g),h=svgCanvas.getEditorNS(!0),m.setAttributeNS(h,"se:connector",d),m.setAttribute("class",C.substr(1)),m.setAttribute("opacity",1),svgCanvas.addToSelection([m]),svgCanvas.moveToBottomSelectedElement(),b.requestSelector(m).showGrips(!1),{keep:!(k=!1),element:m,started:k}}},selectedChanged:function(e){if($(x).find(C).length){"connector"==svgCanvas.getMode()&&svgCanvas.setMode("select");for(var t=(E=e.elems).length;t--;){var r=E[t];r&&S(r,"c_start")?(b.requestSelector(r).showGrips(!1),e.selectedElement&&!e.multiselected?n(!0):n(!1)):n(!1)}F()}},elementChanged:function(e){var t,r=e.elems[0];if(r&&"svg"===r.tagName&&"svgcontent"===r.id&&(x=r,$(x).find("*").each(function(){var e=this.getAttributeNS(h,"connector");if(e){this.setAttribute("class",C.substr(1));var t=e.split(" "),r=svgCanvas.getStrokedBBox([w(t[0])]),n=svgCanvas.getStrokedBBox([w(t[1])]);$(this).data("c_start",t[0]).data("c_end",t[1]).data("start_bb",r).data("end_bb",n),svgCanvas.getEditorNS(!0)}})),r&&(r.getAttribute("marker-start")||r.getAttribute("marker-mid")||r.getAttribute("marker-end"))){t=r.getAttribute("marker-start");var n=r.getAttribute("marker-mid"),i=r.getAttribute("marker-end");if(m=r,$(r).data("start_off",!!t).data("end_off",!!i),"line"===r.tagName&&n){var o=Number(r.getAttribute("x1")),a=Number(r.getAttribute("x2")),s=Number(r.getAttribute("y1")),d=Number(r.getAttribute("y2")),l=r.id,g=y({element:"polyline",attr:{points:o+","+s+(" "+(o+a)/2+","+(s+d)/2+" ")+a+","+d,stroke:r.getAttribute("stroke"),"stroke-width":r.getAttribute("stroke-width"),"marker-mid":n,fill:"none",opacity:r.getAttribute("opacity")||1}});$(r).after(g).remove(),svgCanvas.clearSelection(),g.id=l,svgCanvas.addToSelection([g]),r=g}}r.getAttribute("class")==C.substr(1)?F([t=w(S(r,"c_start"))]):F()},toolButtonStateUpdate:function(e){e.nostroke&&$("#mode_connect").hasClass("tool_button_current")&&svgEditor.clickSelect(),$("#mode_connect").toggleClass("disabled",e.nostroke)}}})},window.extEyedropper=function(){window.svgEditor&&svgEditor.addExtension("eyedropper",function(e){"use strict";var o=svgEditor.canvas,a=svgedit.history.ChangeElementCommand,s={fillPaint:"red",fillOpacity:1,strokePaint:"black",strokeOpacity:1,strokeWidth:5,strokeDashArray:null,opacity:1,strokeLinecap:"butt",strokeLinejoin:"miter"};function t(e){if("eyedropper"!=o.getMode()){var t=null,r=$("#tool_eyedropper");!e.multiselected&&e.elems[0]&&-1===$.inArray(e.elems[0].nodeName,["svg","g","use"])?(t=e.elems[0],r.removeClass("disabled"),s.fillPaint=t.getAttribute("fill")||"black",s.fillOpacity=t.getAttribute("fill-opacity")||1,s.strokePaint=t.getAttribute("stroke"),s.strokeOpacity=t.getAttribute("stroke-opacity")||1,s.strokeWidth=t.getAttribute("stroke-width"),s.strokeDashArray=t.getAttribute("stroke-dasharray"),s.strokeLinecap=t.getAttribute("stroke-linecap"),s.strokeLinejoin=t.getAttribute("stroke-linejoin"),s.opacity=t.getAttribute("opacity")||1):r.addClass("disabled")}}return{name:"eyedropper",buttons:[{id:"tool_eyedropper",type:"mode",title:"Eye Dropper Tool",key:"I",events:{click:function(){o.setMode("eyedropper")}}}],selectedChanged:t,elementChanged:t,mouseDown:function(e){var t;if("eyedropper"==o.getMode()){var r=e.event.target;if(-1===$.inArray(r.nodeName,["svg","g","use"])){var n={},i=function(e,t,r){n[t]=e.getAttribute(t),e.setAttribute(t,r)};s.fillPaint&&i(r,"fill",s.fillPaint),s.fillOpacity&&i(r,"fill-opacity",s.fillOpacity),s.strokePaint&&i(r,"stroke",s.strokePaint),s.strokeOpacity&&i(r,"stroke-opacity",s.strokeOpacity),s.strokeWidth&&i(r,"stroke-width",s.strokeWidth),s.strokeDashArray&&i(r,"stroke-dasharray",s.strokeDashArray),s.opacity&&i(r,"opacity",s.opacity),s.strokeLinecap&&i(r,"stroke-linecap",s.strokeLinecap),s.strokeLinejoin&&i(r,"stroke-linejoin",s.strokeLinejoin),t=new a(r,n),o.undoMgr.addCommandToHistory(t)}}}}})},window.extGrid=function(){window.svgEditor&&svgEditor.addExtension("view_grid",function(){"use strict";var e=svgedit.NS,c=svgEditor.canvas,t=document.getElementById("svgcanvas").ownerDocument,r=svgEditor.curConfig.showGrid||!1,n=c.assignAttributes,v=document.createElement("canvas"),i=$("#canvasBackground"),u=svgedit.units.getTypeMap(),m=[.01,.1,1,10,100,1e3];$(v).hide().appendTo("body");var o=t.createElementNS(e.SVG,"svg");n(o,{id:"canvasGrid",width:"100%",height:"100%",x:0,y:0,overflow:"visible",display:"none"}),i.append(o);var a=t.createElementNS(e.SVG,"pattern");n(a,{id:"gridpattern",patternUnits:"userSpaceOnUse",x:0,y:0,width:100,height:100});var p=t.createElementNS(e.SVG,"image");n(p,{x:0,y:0,width:100,height:100}),a.appendChild(p),$("#svgroot defs").append(a);var s=t.createElementNS(e.SVG,"rect");function d(e){var t,r=u[svgEditor.curConfig.baseUnit]*e,n=100/r,i=1;for(t=0;t<m.length;t++){var o=m[t];if(n<=(i=o))break}var a=i*r;v.width=a,v.height=a;var s=v.getContext("2d"),d=a/10;for(s.globalAlpha=.2,s.strokeStyle=svgEditor.curConfig.gridColor,t=1;t<10;t++){var l=Math.round(d*t)+.5;s.moveTo(l,a),s.lineTo(l,0),s.moveTo(a,l),s.lineTo(0,l)}s.stroke(),s.beginPath(),s.globalAlpha=.5,s.moveTo(.5,a),s.lineTo(.5,0),s.moveTo(a,.5),s.lineTo(0,.5),s.stroke();var g=v.toDataURL("image/png");p.setAttribute("width",a),p.setAttribute("height",a),p.parentNode.setAttribute("width",a),p.parentNode.setAttribute("height",a),c.setHref(p,g)}function l(){r&&d(c.getZoom()),$("#canvasGrid").toggle(r)}return n(s,{width:"100%",height:"100%",x:0,y:0,"stroke-width":0,stroke:"none",fill:"url(#gridpattern)",style:"pointer-events: none; display:visible;"}),$("#canvasGrid").append(s),{name:"view_grid",zoomChanged:function(e){r&&d(e)},callback:function(){r&&l()},buttons:[{id:"view_grid",events:{click:function(){svgEditor.curConfig.showGrid=r=!r,l()}}}]}})},window.extMarkers=function(){window.svgEditor&&svgEditor.addExtension("Markers",function(f){var h,x=f.addSvgElementFromJson,l=["start","mid","end"],g="se_marker_",w={nomarker:{label:"&#x2014;"},leftarrow:{element:"path",attr:{d:"M0,50 L100,90 L70,50 L100,10 Z"},label:"&#x25C4;"},rightarrow:{element:"path",attr:{d:"M100,50 L0,90 L30,50 L0,10 Z"},label:"&#x25BA;"},leftpointing:{element:"path",attr:{d:"M50,48 L90,90 M50,52 L90,10"},label:"&#x2009;&#x02C2;"},rightpointing:{element:"path",attr:{d:"M50,48 L10,90 L50,52 L10,10 Z"},label:"&#x2009;&#x003E;"},break:{element:"path",attr:{d:"M50,20 L50,80"},label:"&#x2009;&#x2223;"},mcircle:{element:"circle",attr:{r:30,cx:50,cy:50},label:"&#x2009;&#x25CF;"}};function c(e,t){var r=e.getAttribute(t);if(!r)return null;var n=r.match(/\(\#(.*)\)/);return n&&2===n.length?f.getElem(n[1]):null}function s(e,r){"\\"!==r.substr(0,1)&&(r="\\textmarker");var t=document.getElementById(e+"_marker"),n=0;$.each(w,function(e,t){if(-1!==r.indexOf(e))return!1;n++}),t.selectedIndex=n}function i(e){if($("#marker_panel").toggle(e),e){var i,o,a=h[0];$.each(l,function(e,t){var r=c(a,"marker-"+t),n=$("#"+t+"_marker");if(r){if(!r.attributes.se_type)return;i="\\"+r.attributes.se_type.textContent,"\\textmarker"===(o=i)?i=r.lastChild.textContent:n.hide()}else o=i="\\nomarker",n.hide();n.val(i),s(t,o)})}}function v(e,t){var r=f.getElem(e);if(!r&&""!=t&&"\\nomarker"!=t){var n,i=h[0].getAttribute("stroke"),o=50,a=50,s="0 0 100 100",d=10,l=10;if(n="\\"===t.substr(0,1)?t.substr(1):"textmarker",w[n]){if(r=x({element:"marker",attr:{id:e,orient:"auto",style:"pointer-events:none",se_type:n}}),"textmarker"!=n){var g=x(w[n]),c=i;"_o"===n.substr(-2)&&(c="none"),g.setAttribute("fill",c),g.setAttribute("stroke",i),g.setAttribute("stroke-width",10),r.appendChild(g)}else{var v=x(w[n]);v.textContent=t;var u=v.getBBox(),m=u;m.x=0,m.y=0,m.width+=2,m.height+=2,v.setAttribute("x",1),v.setAttribute("y",m.height-1-u.height/4),v.setAttribute("fill",i),o=m.width/2+1,a=m.height/2+1,s=m.x+" "+m.y+" "+m.width+" "+m.height,d=m.width/10,l=m.height/10;var p=x({element:"rect",attr:{x:m.x,y:m.y,width:m.width,height:m.height,fill:"#ffffff",stroke:"none","stroke-width":0}});r.setAttribute("orient",0),r.appendChild(p),r.appendChild(v)}return r.setAttribute("viewBox",s),r.setAttribute("markerWidth",d),r.setAttribute("markerHeight",l),r.setAttribute("refX",o),r.setAttribute("refY",a),f.findDefs().appendChild(r),r}}}function u(n){if("line"!==n.tagName)return n;var e=Number(n.getAttribute("x1")),t=Number(n.getAttribute("x2")),r=Number(n.getAttribute("y1")),i=Number(n.getAttribute("y2")),o=n.id,a=x({element:"polyline",attr:{points:e+","+r+(" "+(e+t)/2+","+(r+i)/2+" ")+t+","+i,stroke:n.getAttribute("stroke"),"stroke-width":n.getAttribute("stroke-width"),fill:"none",opacity:n.getAttribute("opacity")||1}});$.each(l,function(e,t){var r="marker-"+t;n.getAttribute(r)&&a.setAttribute(r,n.getAttribute(r))});var s=new f.BatchCommand;return s.addSubCommand(new f.RemoveElementCommand(n,n.parentNode)),s.addSubCommand(new f.InsertElementCommand(a)),$(n).after(a).remove(),svgCanvas.clearSelection(),a.id=o,svgCanvas.addToSelection([a]),f.addCommandToHistory(s),a}return{name:"Markers",mySetMarker:function(e,r){var n=void 0,i=0;$.each(w,function(e,t){r===i++&&(n=e)}),function(e,t){var r={start_marker:"start",mid_marker:"mid",end_marker:"end"}[e],n="marker-"+r,i=t,o=h[0],a=c(o,n);if(a&&$(a).remove(),o.removeAttribute(n),""==i&&(i="\\nomarker"),"\\nomarker"==i)return s(r,i),f.call("changed",h);v(e=g+r+"_"+o.id,i),svgCanvas.changeSelectedAttribute(n,"url(#"+e+")"),"line"===o.tagName&&"mid"==r&&(o=u(o)),f.call("changed",h),s(r,i)}(e,"\\"+n)},callback:function(){var a=document.getElementById("start_marker"),s=document.getElementById("mid_marker"),d=document.getElementById("end_marker");$.each(w,function(e,t){if(t.label){var r=document.createElement("option");r.value=t.label,r.innerHTML=t.label,r.setAttribute("style","background-color: rgba(33,33,33,1);color: rgba(255,255,255,1);");var n=r.cloneNode(!0),i=r.cloneNode(!0),o=r.cloneNode(!0);a.appendChild(n),s.appendChild(i),d.appendChild(o)}})},selectedChanged:function(e){for(var t=(h=e.elems).length,r=["line","path","polyline"];t--;){var n=h[t];n&&-1!==$.inArray(n.tagName,r)&&e.selectedElement&&!e.multiselected?i(!0):i(!1)}},elementChanged:function(e){var d,a,s,t=e.elems[0];if(t&&(t.getAttribute("marker-start")||t.getAttribute("marker-mid")||t.getAttribute("marker-end"))){s=(a=t).getAttribute("stroke"),$.each(l,function(e,t){var r=c(a,"marker-"+t);if(r&&r.attributes.se_type){var n=r.lastElementChild;if(n){var i=n.getAttribute("fill"),o=n.getAttribute("stroke");i&&"none"!=i&&n.setAttribute("fill",s),o&&"none"!=o&&n.setAttribute("stroke",s)}}}),d=t,$.each(l,function(e,t){var r=g+t+"_"+d.id,n="marker-"+t,i=c(d,n);if(i&&i.attributes.se_type){var o=d.getAttribute(n);if(o){var a=d.id.length,s=o.substr(-a-1,a);d.id!=s&&(v(r,$("#"+t+"_marker").attr("value")),svgCanvas.changeSelectedAttribute(n,"url(#"+r+")"),"line"===d.tagName&&"mid"==t&&(d=u(d)),f.call("changed",h))}}});t&&-1!==$.inArray(t.tagName,["line","path","polyline"])&&i(!0)}}}})},window.extOverview=function(){if(window.svgEditor){var t={};svgEditor.addExtension("overview_window",function(){"use strict";$("#sidepanels").append('\t\t<div id="overview_window_content_pane" style=" width:100%; word-wrap:break-word;  display:inline-block; margin-top:20px;">\t\t\t<div id="overview_window_content" style="position:relative; left:12px; top:0px;">\t\t\t\t<div style="background-color:#A0A0A0; display:inline-block; overflow:visible;">\t\t\t\t\t<svg id="overviewMiniView" width="150" height="100" x="0" y="0" viewBox="0 0 4800 3600" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">\t\t\t\t\t\t<use x="0" y="0" xlink:href="#svgroot"> </use>\t\t\t\t\t </svg>\t\t\t\t\t <div id="overview_window_view_box" style="min-width:50px; min-height:50px; position:absolute; top:30px; left:30px; z-index:5; background-color:rgba(255,0,102,0.3);">\t\t\t\t\t </div>\t\t\t\t </div>\t\t\t</div>\t\t</div>');var o=function(){var e=parseFloat($("#workarea").css("height")),t=parseFloat($("#workarea").css("width")),r=$("#workarea").scrollLeft(),n=$("#workarea").scrollTop(),i=parseFloat($("#svgcanvas").css("width")),o=parseFloat($("#svgcanvas").css("height")),a=$("#overviewMiniView").attr("width"),s=$("#overviewMiniView").attr("height"),d=r/i*a,l=n/o*s,g=t/i*a,c=e/o*s;$("#overview_window_view_box").css("min-width",g+"px"),$("#overview_window_view_box").css("min-height",c+"px"),$("#overview_window_view_box").css("top",l+"px"),$("#overview_window_view_box").css("left",d+"px")};$("#workarea").scroll(function(){t.viewBoxDragging||o()}),$("#workarea").resize(o),o();var e=function(){var e=$("#svgroot").attr("width"),t=$("#svgroot").attr("height"),r=640,n=480;svgedit.browser.isIE()&&(n=r=0);var i=t/e*$("#overviewMiniView").attr("width");$("#overviewMiniView").attr("viewBox",r+" "+n+" "+e+" "+t),$("#overviewMiniView").attr("height",i),o()};e(),t.viewBoxDragging=!1;var l=function(){var e=parseFloat($("#svgcanvas").css("width")),t=parseFloat($("#svgcanvas").css("height")),r=$("#overviewMiniView").attr("width"),n=$("#overviewMiniView").attr("height"),i=parseFloat($("#overview_window_view_box").css("left"))/r*e,o=parseFloat($("#overview_window_view_box").css("top"))/n*t;$("#workarea").scrollLeft(i),$("#workarea").scrollTop(o)};return $("#overview_window_view_box").draggable({containment:"parent",drag:l,start:function(){t.viewBoxDragging=!0},stop:function(){t.viewBoxDragging=!1}}),$("#overviewMiniView").click(function(e){var t=e.offsetX||e.originalEvent.layerX,r=e.offsetY||e.originalEvent.layerY,n=$("#overviewMiniView").attr("width"),i=$("#overviewMiniView").attr("height"),o=parseFloat($("#overview_window_view_box").css("min-width")),a=parseFloat($("#overview_window_view_box").css("min-height")),s=t-.5*o,d=r-.5*a;s<0&&(s=0),d<0&&(d=0),n<s+o&&(s=n-o),i<d+a&&(d=i-a),$("#overview_window_view_box").css("top",d+"px"),$("#overview_window_view_box").css("left",s+"px"),l()}),{name:"overview window",canvasUpdated:e,workareaResized:o}})}},window.extPanning=function(){window.svgEditor&&svgEditor.addExtension("ext-panning",function(){"use strict";return{name:"Extension Panning",buttons:[{id:"ext-panning",type:"mode",title:"Panning",events:{click:function(){svgCanvas.setMode("ext-panning")}}}],mouseDown:function(){if("ext-panning"==svgCanvas.getMode())return svgEditor.setPanning(!0),{started:!0}},mouseUp:function(){if("ext-panning"==svgCanvas.getMode())return svgEditor.setPanning(!1),{keep:!1,element:null}}}})},window.extStorage=function(){window.svgEditor&&svgEditor.addExtension("storage",function(){var d=svgEditor.curConfig.emptyStorageOnDecline,l=svgEditor.curConfig.noStorageOnLoad,g=svgEditor.curConfig.forceStorage,c=svgEditor.storage;function v(n){n=n?"storagePrompt="+n:"";var e=top.location;-1<e.href.indexOf("storagePrompt=")?e.href=e.href.replace(/([&?])storagePrompt=[^&]*(&?)/,function(e,t,r){return(n?t:"")+n+(!n&&r?t:r||"")}):e.href+=(-1<e.href.indexOf("?")?"&":"?")+n}function u(e){if(c){var t="svgedit-"+svgEditor.curConfig.canvasName;e?c.setItem(t,e):c.removeItem(t)}}function m(e){document.cookie=encodeURIComponent(e)+"=; expires=Thu, 01 Jan 1970 00:00:00 GMT"}function p(){window.addEventListener("beforeunload",function(e){if(document.cookie.match(/(?:^|;\s*)store=(?:prefsAndContent|prefsOnly)/)){var t;document.cookie.match(/(?:^|;\s*)store=prefsAndContent/)&&u(svgCanvas.getSvgString()),svgEditor.setConfig({no_save_warning:!0});var r=svgEditor.curPrefs;for(t in r)if(r.hasOwnProperty(t)){var n=r[t];if(t="web-edit-"+t,!(null!=n))continue;c?c.setItem(t,n):window.widget?widget.setPreferenceForKey(n,t):(n=encodeURIComponent(n),document.cookie=encodeURIComponent(t)+"="+n+"; expires=Fri, 31 Dec 9999 23:59:59 GMT")}}},!1)}var f=!1;return{name:"storage",langReady:function(e){var t=e.uiStrings,r=$.deparam.querystring(!0).storagePrompt;if(!f)if(f=!0,g||!0!==r&&(!1===r||document.cookie.match(/(?:^|;\s*)store=(?:prefsAndContent|prefsOnly)/)))l&&!g||p();else{var n=[];c?n.unshift({value:"prefsAndContent",text:t.confirmSetStorage.storagePrefsAndContent},{value:"prefsOnly",text:t.confirmSetStorage.storagePrefsOnly},{value:"noPrefsOrContent",text:t.confirmSetStorage.storageNoPrefsOrContent}):n.unshift({value:"prefsOnly",text:t.confirmSetStorage.storagePrefs},{value:"noPrefsOrContent",text:t.confirmSetStorage.storageNoPrefs});var i=$("#dialog_container")[0].style.width,o=$("#dialog_container")[0].style.marginLeft,a=$("#dialog_content")[0].style.height,s=$("#dialog_container")[0].style.height;$("#dialog_content")[0].style.height="120px",$("#dialog_container")[0].style.height="170px",$("#dialog_container")[0].style.width="800px",$("#dialog_container")[0].style.marginLeft="-400px",$.select(t.confirmSetStorage.message,n,function(e,t){if(e&&"noPrefsOrContent"!==e){if(document.cookie="store="+encodeURIComponent(e)+"; expires=Fri, 31 Dec 9999 23:59:59 GMT",!0===r&&t)return void v()}else if(m("store"),e&&d&&function(){var e;for(e in u(""),svgEditor.curPrefs)svgEditor.curPrefs.hasOwnProperty(e)&&(e="web-edit-"+e,c&&c.removeItem(e),m(e))}(),e&&t)return void v("false");$("#dialog_container")[0].style.width=i,$("#dialog_container")[0].style.marginLeft=o,$("#dialog_content")[0].style.height=a,$("#dialog_container")[0].style.height=s,p(),svgEditor.storagePromptClosed=!0},null,null,{label:t.confirmSetStorage.rememberLabel,checked:!1,tooltip:t.confirmSetStorage.rememberTooltip})}}}})},window.extSwitch=function(){svgEditor.addExtension("switch",function(_){"use strict";var g,C,E,S,A=svgEditor.canvas,M=A.getRootElem(),I={},N="switch",c="svg-ext-"+N,v="SWI_",u={};return{callback:function(){$("#switch_panel").hide()},mouseDown:function(e){var t=A.getColor("fill"),r=A.getColor("stroke"),n=A.getStrokeWidth();if(A.getMode()===N){for(var i=E=e.start_x,o=S=e.start_y,a={fill:t,stroke:r,"font-size":A.getFontSize(),stroke:r,"stroke-width":n,"font-family":A.getFontFamily(),"text-anchor":"middle","xml:space":"preserve"},s={elements:[{type:"path",attr:{id:"X-"+A.getNextId().replace("svg_",v),d:"m2.9674 294.65-1.9091-2.9389"}},{type:"path",attr:{id:A.getNextId().replace("svg_",v),d:"m2.9959 290.12v1.0583"}},{type:"circle",attr:{id:A.getNextId().replace("svg_",v),cx:"2.9891",cy:"291.41",r:".2581"}},{type:"path",attr:{id:A.getNextId().replace("svg_",v),d:"m2.9959 295.94v-1.0583"}},{type:"circle",attr:{id:A.getNextId().replace("svg_",v),cx:"2.9891",cy:"-294.66",r:".2581",transform:"scale(1,-1)"}}]},d={type:c,x:i,y:o,style:"pointer-events:none"},l=0;l<s.elements.length;l++)$.extend(s.elements[l].attr,a);return $.extend(d,a),u.x=i,u.y=o,g=A.getNextId().replace("svg_",v),(C=_.addSvgGroupFromJson({group:"g",id:g,type:c,attr:d,elements:s.elements})).setAttribute("transform","translate("+i+","+o+") scale(0.005) translate("+-i+","+-o+")"),_.recalculateDimensions(C),I=C.getBBox(),{started:!0}}},mouseMove:function(e){if(A.getMode()===N){var t=A.getZoom(),r=e.event,n=e.mouse_x/t,i=e.mouse_y/t,o=A.getTransformList(C),a=C.getBBox(),s=a.x,d=a.y,l=a.width,g=a.height,c=n-E,v=i-S,u=(Math.min(E,n),Math.min(S,i),Math.abs(n-E)),m=Math.abs(i-S),p=0,f=0,h=g?(g+v)/g:1,x=l?(l+c)/l:1;x=u/I.width||1,h=m/I.height||1,n<E&&(p=I.width),i<S&&(f=I.height);var w=M.createSVGTransform(),y=M.createSVGTransform(),b=M.createSVGTransform();if(w.setTranslate(-(s+p),-(d+f)),!r.shiftKey){var k=Math.min(Math.abs(x),Math.abs(h));x=k*(x<0?-1:1),h=k*(h<0?-1:1)}y.setScale(x,h),b.setTranslate(s+p,d+f),o.appendItem(b),o.appendItem(y),o.appendItem(w),_.recalculateDimensions(C),I=C.getBBox()}},mouseUp:function(e){if(A.getMode()===N)return{keep:e.event.clientX!=u.x&&e.event.clientY!=u.y,element:C,started:!1}},getClassId:function(){return c}}})},window.extValue=function(){svgEditor.addExtension("value",function(l){"use strict";var g,c,v=svgEditor.canvas,u="value",m="svg-ext-"+u,p="VAL_",f={};return{callback:function(){$("#value_panel").hide()},mouseDown:function(e){if(v.getMode()===u){var t=v.getColor("fill"),r=v.getColor("stroke");t!==r&&(t=r);for(var n=e.start_x,i=e.start_y,o={fill:t,stroke:r,"font-size":v.getFontSize(),stroke:r,"stroke-width":0,"font-family":v.getFontFamily(),"text-anchor":"middle","xml:space":"preserve",x:n,y:i},a={elements:[{type:"text",content:"##.##",attr:{id:v.getNextId().replace("svg_",p)}}]},s={type:m,x:n,y:i,style:"pointer-events:none"},d=0;d<a.elements.length;d++)$.extend(a.elements[d].attr,o);return $.extend(s,o),f.x=n,f.y=i,g=v.getNextId().replace("svg_",p),c=l.addSvgGroupFromJson({group:"g",id:g,type:m,attr:s,elements:a.elements}),{started:!0}}},mouseMove:function(e){},mouseUp:function(e){if(v.getMode()===u)return{keep:e.event.clientX!=f.x&&e.event.clientY!=f.y,element:c,started:!1}},getClassId:function(){return m},setGaugeAttribute:function(e){0===e.elem.id.indexOf(p)&&e.elem.children&&e.elem.children.length&&e.elem.children[0].setAttribute(e.attr,e.value)}}})},window.extHtmlInput=function(){window.svgEditor&&svgEditor.addExtension("html_input",function(d){"use strict";var l,g,c=svgEditor.canvas,v=80,u=24,m="html_input",p="svg-ext-"+m,t={};return{callback:function(){$("#html_input_panel").hide()},mouseDown:function(e){if(c.getMode()===m){!0;var t=c.getColor("fill"),r=c.getColor("stroke"),n=e.start_x,i=e.start_y,o=c.getNextId(),a=c.getNextId().replace("svg_","HXI_"),s={elements:[{type:"rect",attr:{x:n,y:i-u,width:v,height:u,"stroke-width":0,id:o}},{type:"foreignObject",content:[{tag:"input",attr:{id:"I-"+a,type:"text",value:""},style:"width:calc(100% - 7px);height:calc(100% - 7px);text-align: right;border: unset;"}],attr:{x:n,y:i-u,height:u,width:v,id:"H-"+a}}]};return l=d.getNextId().replace("svg_","HXI_"),g=d.addSvgGroupFromJson({group:"g",id:l,type:p,attr:{type:p,style:"pointer-events:none",fill:t,stroke:r,"stroke-width":1,"font-size":c.getFontSize(),"font-family":c.getFontFamily(),"text-anchor":"right","xml:space":"preserve"},elements:s.elements}),{started:!0}}},mouseMove:function(e){},mouseUp:function(e){if(c.getMode()===m)return{keep:e.event.clientX!=t.x&&e.event.clientY!=t.y,element:g,started:!1}},getClassId:function(){return p}}})},window.extHtmlButton=function(){window.svgEditor&&svgEditor.addExtension("html_button",function(d){"use strict";var l,g,c=svgEditor.canvas,v=80,u=24,m="html_button",p="svg-ext-"+m,t={};return{callback:function(){$("#html_button_panel").hide()},mouseDown:function(e){if(c.getMode()===m){!0;var t=c.getColor("fill"),r=c.getColor("stroke"),n=e.start_x,i=e.start_y,o=c.getNextId(),a=c.getNextId().replace("svg_","HXB_"),s={elements:[{type:"rect",attr:{x:n,y:i-u,width:v,height:u,"stroke-width":0,id:o}},{type:"foreignObject",content:[{tag:"button",attr:{id:"B-"+a,class:"md-btn  md-btn-raised"},style:"width:calc(100% - 6px);height:calc(100% - 6px);background-color:"+t+";color:"+r+";"}],attr:{x:n,y:i-u,height:u,width:v,id:"H-"+a}}]};return l=c.getNextId().replace("svg_","HXB_"),g=d.addSvgGroupFromJson({group:"g",id:l,type:p,attr:{type:p,style:"pointer-events:none",fill:"rgba(0,0,0,0)",stroke:"rgba(0,0,0,0)","font-size":c.getFontSize(),"font-family":c.getFontFamily(),"text-anchor":"right","xml:space":"preserve"},elements:s.elements}),{started:!0}}},mouseMove:function(e){},mouseUp:function(e){if(c.getMode()===m)return{keep:e.event.clientX!=t.x&&e.event.clientY!=t.y,element:g,started:!1}},getClassId:function(){return p}}})},window.extHtmlSelect=function(){window.svgEditor&&svgEditor.addExtension("html_select",function(d){"use strict";var l,g,c=svgEditor.canvas,v=80,u=26,m="html_select",p="svg-ext-"+m,t={};return{callback:function(){$("#html_select_panel").hide()},mouseDown:function(e){if(c.getMode()===m){!0;var t=c.getColor("fill"),r=c.getColor("stroke"),n=e.start_x,i=e.start_y,o=c.getNextId(),a=c.getNextId().replace("svg_","HXS_"),s={elements:[{type:"rect",attr:{x:n,y:i-u,width:v,height:u,fill:t,stroke:r,"stroke-width":0,id:o}},{type:"foreignObject",content:[{tag:"select",attr:{id:"S-"+a},style:"width:100%;height:100%;text-align: right;margin-top:unset;"}],attr:{x:n,y:i-u,height:u,width:v,id:"H-"+a}}]};return l=d.getNextId().replace("svg_","HXS_"),g=d.addSvgGroupFromJson({group:"g",id:l,type:p,attr:{type:p,style:"pointer-events:none",fill:t,stroke:r,"stroke-width":1,"font-size":c.getFontSize(),"font-family":c.getFontFamily(),"text-anchor":"right","xml:space":"preserve"},elements:s.elements}),{started:!0}}},mouseMove:function(e){},mouseUp:function(e){if(c.getMode()===m)return{keep:e.event.clientX!=t.x&&e.event.clientY!=t.y,element:g,started:!1}},getClassId:function(){return p}}})},window.extHtmlChart=function(){window.svgEditor&&svgEditor.addExtension("html_chart",function(d){"use strict";var l,g,c=svgEditor.canvas,v=380,u=240,m="html_chart",p="svg-ext-"+m,f="HXC_",r={};return{callback:function(){$("#html_chart_panel").hide()},mouseDown:function(e){if(c.getMode()===m){!0;var t=c.getColor("fill"),r=c.getColor("stroke"),n=e.start_x,i=e.start_y,o=c.getNextId(),a=c.getNextId().replace("svg_",f),s={elements:[{type:"rect",attr:{x:n,y:i-u,width:v,height:u,"stroke-width":0,id:o}},{type:"foreignObject",content:[{tag:"div",attr:{id:"D-"+a},style:"width:100%;height:100%;"}],attr:{x:n,y:i-u,height:u,width:v,id:"H-"+a}}]};return l=d.getNextId().replace("svg_",f),g=d.addSvgGroupFromJson({group:"g",id:l,type:p,attr:{type:p,style:"pointer-events:none",fill:t,stroke:r,"stroke-width":1,"font-size":c.getFontSize(),"font-family":c.getFontFamily(),"text-anchor":"right","xml:space":"preserve"},elements:s.elements}),{started:!0}}},mouseMove:function(e){if("resize"===c.getMode()&&e&&e.selected&&e.selected.id&&e.selected.id.startsWith(f))return e.selected.id},mouseUp:function(e){var t=c.getMode();return t!==m?"select"===t&&e&&e.selected&&e.selected.id&&e.selected.id.startsWith(f)?e.selected.id:void 0:{keep:e.event.clientX!=r.x&&e.event.clientY!=r.y,element:g,started:!1}},getClassId:function(){return p}}})},window.extHtmlBag=function(){window.svgEditor&&svgEditor.addExtension("html_bag",function(d){"use strict";var l,g,c=svgEditor.canvas,v=200,u=160,m="html_bag",p="svg-ext-"+m,f="BAG_",r={};return{callback:function(){},mouseDown:function(e){if(c.getMode()===m){!0;var t=c.getColor("fill"),r=c.getColor("stroke"),n=e.start_x,i=e.start_y,o=c.getNextId(),a=c.getNextId().replace("svg_",f),s={elements:[{type:"rect",attr:{x:n,y:i-u,width:v,height:u,"stroke-width":0,id:o}},{type:"foreignObject",content:[{tag:"div",attr:{id:"D-"+a},style:"width:100%;height:100%;"}],attr:{x:n,y:i-u,height:u,width:v,id:"H-"+a}}]};return l=d.getNextId().replace("svg_",f),g=d.addSvgGroupFromJson({group:"g",id:l,type:p,attr:{type:p,style:"pointer-events:none",fill:t,stroke:r,"stroke-width":1,"font-size":c.getFontSize(),"font-family":c.getFontFamily(),"text-anchor":"right","xml:space":"preserve"},elements:s.elements}),{started:!0}}},mouseMove:function(e){if("resize"===c.getMode()&&e&&e.selected&&e.selected.id&&e.selected.id.startsWith(f))return e.selected.id},mouseUp:function(e){var t=c.getMode();return t!==m?"select"===t&&e&&e.selected&&e.selected.id&&e.selected.id.startsWith(f)?e.selected.id:void 0:{keep:e.event.clientX!=r.x&&e.event.clientY!=r.y,element:g,started:!1}},getClassId:function(){return p}}})},window.extGaugeProgress=function(){window.svgEditor&&svgEditor.addExtension("gauge_progress",function(u){"use strict";var m,p,f=svgEditor.canvas,h=100,x=25,w="gauge_progress",y="svg-ext-"+w,b="GXP_",k={};return{callback:function(){$("#gauge_progress_panel").hide()},mouseDown:function(e){if(f.getMode()===w){var t,r=f.getColor("fill"),n=f.getColor("stroke"),i=f.getStrokeWidth(),o=f.getFontSize(),a=e.start_x,s=e.start_y-h,d={"font-size":o,stroke:n,"stroke-width":i,"font-family":f.getFontFamily(),"xml:space":"preserve"},l=f.getNextId().replace("svg_",b);t=[];for(var g={elements:[{type:"rect",attr:{id:"A-"+f.getNextId().replace("svg_",b),x:a,y:s,width:x,height:h,fill:r}},{type:"rect",attr:{id:"B-"+f.getNextId().replace("svg_",b),x:a,y:s+h/2,width:x,height:h/2,fill:"#1565c0"}},{type:"foreignObject",content:t,attr:{x:a,y:s,height:h,width:x,id:"H-"+l}}]},c={type:y,x:a,y:s,style:"pointer-events:none"},v=0;v<g.elements.length;v++)$.extend(g.elements[v].attr,d);return $.extend(c,d),k.x=a,k.y=s,m=f.getNextId().replace("svg_",b),p=u.addSvgGroupFromJson({group:"g",id:m,type:y,attr:c,elements:g.elements}),{started:!0}}},mouseMove:function(e){f.getMode()},mouseUp:function(e){if(f.getMode()===w)return{keep:e.event.clientX!=k.x&&e.event.clientY!=k.y,element:p,started:!1}},getClassId:function(){return y}}})},window.extGaugeSemaphore=function(){svgEditor.addExtension("gauge_semaphore",function(g){"use strict";var c,v,u=svgEditor.canvas,m="gauge_semaphore",p="svg-ext-"+m,f={};return{callback:function(){$("#gauge_semaphore_panel").hide()},mouseDown:function(e){if(u.getMode()===m){for(var t=u.getColor("fill"),r=u.getColor("stroke"),n=u.getStrokeWidth(),i=e.start_x,o=e.start_y-30,a={fill:t,"font-size":u.getFontSize(),stroke:r,"stroke-width":n,"font-family":u.getFontFamily(),"xml:space":"preserve"},s={elements:[{type:"ellipse",attr:{id:u.getNextId().replace("svg_","GSE_"),cx:"15",cy:"15",rx:"14",ry:"14","stroke-width":"none"}}]},d={type:p,x:i,y:o,style:"pointer-events:none"},l=0;l<s.elements.length;l++)$.extend(s.elements[l].attr,a);return $.extend(d,a),f.x=i,f.y=o,c=u.getNextId().replace("svg_","GSE_"),(v=g.addSvgGroupFromJson({group:"g",id:c,type:p,attr:d,elements:s.elements})).setAttribute("transform","translate("+i+","+o+")"),g.recalculateDimensions(v),v.getBBox(),{started:!0}}},mouseMove:function(e){},mouseUp:function(e){if(u.getMode()===m)return{keep:e.event.clientX!=f.x&&e.event.clientY!=f.y,element:v,started:!1}},getClassId:function(){return p}}})},console.log("ext-editor V0.006"),window.extShapes=function(){window.svgEditor&&svgEditor.addExtension("shapes",function(){"use strict";var _,p,C,E,S,f=svgEditor.shapesList,A=svgEditor.canvas,M={},h="svg-ext-",x={};return{callback:function(){},mouseDown:function(e){var t=A.getMode();if(h="svg-ext-"+t,p=t,void 0!==(_=f.find(function(e){return e.name===p}))){var r=A.getColor("fill"),n=A.getColor("stroke"),i=A.getFontSize(),o=A.getFontFamily(),a=A.getStrokeWidth();A.getStyle();r===n&&(r="#FFFFFF",n="#000000");for(var s=E=e.start_x,d=S=e.start_y,l={fill:r,stroke:n,"stroke-width":a,"font-size":i,"font-family":o,"text-anchor":"middle","xml:space":"preserve"},g={elements:[]},c=0;c<_.content.length;c++){var v=_.content[c],u={id:v.id+A.getNextId().replace("svg_","SHE_"),"stroke-width":a};$.extend(u,v.attr),g.elements.push({type:v.type,content:v.content,attr:u})}var m={type:h,x:s,y:d,style:"pointer-events:none"};return $.extend(m,l),x.x=s,x.y=d,p=A.getNextId().replace("svg_","SHE_"),(C=A.addSvgGroupFromJson({group:"g",id:p,type:h,attr:m,elements:g.elements})).setAttribute("transform","translate("+s+","+d+")"),A.recalculateDimensions(C),M=C.getBBox(),{started:!0}}},mouseMove:function(e){if(void 0!==_){var t=A.getZoom(),r=e.event,n=e.mouse_x/t,i=e.mouse_y/t;svgEditor.curConfig.gridSnapping&&(n=svgedit.utilities.snapToGrid(n),i=svgedit.utilities.snapToGrid(i));var o=A.getTransformList(C),a=C.getBBox(),s=a.x,d=a.y,l=a.width,g=a.height,c=n-E,v=i-S,u=(Math.min(E,n),Math.min(S,i),Math.abs(n-E)),m=Math.abs(i-S),p=0,f=0,h=g?(g+v)/g:1,x=l?(l+c)/l:1;x=u/M.width||1,h=m/M.height||1,n<E&&(p=M.width),i<S&&(f=M.height);var w=svgroot.createSVGTransform(),y=svgroot.createSVGTransform(),b=svgroot.createSVGTransform();if(w.setTranslate(-(s+p),-(d+f)),!r.shiftKey){var k=Math.min(Math.abs(x),Math.abs(h));x=k*(x<0?-1:1),h=k*(h<0?-1:1)}y.setScale(x,h),b.setTranslate(s+p,d+f),o.appendItem(b),o.appendItem(y),o.appendItem(w),A.recalculateDimensions(C),M=C.getBBox()}},mouseUp:function(e){if(void 0!==_)return{keep:e.event.clientX!=x.x&&e.event.clientY!=x.y,element:C,started:!1}},getClassId:function(){return h}}})},window.extLinear=function(){window.svgEditor&&svgEditor.addExtension("help-linear",function(){"use strict";var e="rgba(255, 0, 0, 0.5)",o=svgEditor.canvas,a=["line","path","pipe"],s=!1,t=svgedit.NS,d=o.assignAttributes,r=document.getElementById("svgcanvas").ownerDocument,l=document.getElementById("canvasBackground"),g=r.createElementNS(t.SVG,"line");d(g,{x1:0,y1:0,x2:0,y2:0,"stroke-width":1,stroke:e});var c=r.createElementNS(t.SVG,"line");function n(){s=!1,d(g,{x1:0,y1:0,x2:0,y2:0}),d(c,{x1:0,y1:0,x2:0,y2:0})}return d(c,{x1:0,y1:0,x2:0,y2:0,"stroke-width":1,stroke:e}),l.append(g),l.append(c),{callback:function(){},mouseDown:function(e){var t=o.getMode();-1!==a.indexOf(t)?s=!0:n()},mouseMove:function(e){if(s){var t=o.getMode();-1!==a.indexOf(t)&&(r=e.mouse_x,n=e.mouse_y,i=l.getBBox(),d(g,{x1:r,y1:0,x2:r,y2:i.height}),d(c,{x1:0,y1:n,x2:i.width,y2:n}))}var r,n,i},mouseUp:function(e){if(s&&"line"!=o.getMode())return;n()}}})},window.extPipe=function(){window.svgEditor&&svgEditor.addExtension("pipe",function(e){"use strict";var c=svgEditor.canvas,v="svg-ext-pipe",u="PIE_";return{name:"pipe",initPipe:function(e){if(!e||!e[0])return!1;var t=document.getElementById(e[0].id);if(!t)return!1;var r=e[0].property;if("path"==t.nodeName){var n=t.getBBox(),i=t.getAttribute("d"),o=r.contentSpace+" "+r.contentSpace;t.remove();var a=[{type:"path",attr:{id:"b"+c.getNextId().replace("svg_",u),d:i,"stroke-width":r.borderWidth,stroke:r.border,fill:"none"}},{type:"path",attr:{id:"p"+c.getNextId().replace("svg_",u),d:i,"stroke-width":r.pipeWidth,stroke:r.pipe,fill:"none"}},{type:"path",attr:{id:"c"+c.getNextId().replace("svg_",u),d:i,"stroke-width":r.contentWidth,stroke:r.content,fill:"none","stroke-dasharray":o}}],s=c.getNextId().replace("svg_",u),d={type:v,x:n.x,y:n.y,style:"pointer-events:none"};return $.extend(d,{"xml:space":"preserve"}),{keep:!0,element:c.addSvgGroupFromJson({group:"g",id:s,type:v,attr:d,elements:a}),started:!1}}for(var l=0;l<t.childNodes.length;l++){var g=t.childNodes[l];if(0<=g.id.indexOf("b"+u))g.setAttribute("stroke-width",r.borderWidth),g.setAttribute("stroke",r.border);else if(0<=g.id.indexOf("p"+u))g.setAttribute("stroke-width",r.pipeWidth),g.setAttribute("stroke",r.pipe);else if(0<=g.id.indexOf("c"+u)){g.setAttribute("stroke-width",r.contentWidth),g.setAttribute("stroke",r.content);o=r.contentSpace+" "+r.contentSpace;g.setAttribute("stroke-dasharray",o)}}return{keep:!0,element:t,started:!1}}}})},window.extHtmlSlider=function(){window.svgEditor&&svgEditor.addExtension("html_slider",function(d){"use strict";var l,g,c=svgEditor.canvas,v=200,u=200,m="html_slider",p="svg-ext-"+m,f="SLI_",r={};return{callback:function(){},mouseDown:function(e){if(c.getMode()===m){!0;var t=c.getColor("fill"),r=c.getColor("stroke"),n=e.start_x,i=e.start_y,o=c.getNextId(),a=c.getNextId().replace("svg_",f),s={elements:[{type:"rect",attr:{x:n,y:i-u,width:v,height:u,"stroke-width":0,id:o}},{type:"foreignObject",content:[{tag:"div",attr:{id:"D-"+a},style:"width:100%;height:100%;"}],attr:{x:n,y:i-u,height:u,width:v,id:"H-"+a}}]};return l=d.getNextId().replace("svg_",f),g=d.addSvgGroupFromJson({group:"g",id:l,type:p,attr:{type:p,style:"pointer-events:none",fill:t,stroke:r,"stroke-width":1,"font-size":c.getFontSize(),"font-family":c.getFontFamily(),"text-anchor":"right","xml:space":"preserve"},elements:s.elements}),{started:!0}}},mouseMove:function(e){if("resize"===c.getMode()&&e&&e.selected&&e.selected.id&&e.selected.id.startsWith(f))return e.selected.id},mouseUp:function(e){var t=c.getMode();return t!==m?"select"===t&&e&&e.selected&&e.selected.id&&e.selected.id.startsWith(f)?e.selected.id:void 0:{keep:e.event.clientX!=r.x&&e.event.clientY!=r.y,element:g,started:!1}},getClassId:function(){return p}}})};